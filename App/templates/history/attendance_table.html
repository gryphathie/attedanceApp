{% extends "base.html" %} 
{% load static %} 
{% load crispy_forms_tags %} 
{% block content %}

<style>
  table.sortable
    th:not(.sorttable_sorted):not(.sorttable_sorted_reverse):not(
      .sorttable_nosort
    ):after {
    content: " \25B4\25BE";
  }
</style>
<link
  href="http://cdn.jsdelivr.net/timepicker.js/latest/timepicker.min.css"
  rel="stylesheet"
/>

<body class="bg-gradient-dark">
  <div class="container-fluid">
    <!-- Outer Row -->
    <div class="row justify-content-center">
      <div class="col-xl-10 col-lg-12 col-mdd-9">
        <form method="POST">
          {% csrf_token %} {% for message in messages %}
          <div class="alert {{ message.tags }} mb-4" role="alert">
            <strong>{{ message }}</strong>
          </div>
          {% endfor %}
          <div class="card o-hidden border-left-info shadow-lg my-1">
            <div class="card-header text-center">
              <h1 class="h4 text-gray-900 mt-2">Attendance Table</h1>
              <p>Details of attendance by employee</p>
            </div>
            <div class="card-body p-0">
              <div class="row border border-primary rounded mx-3 my-2 pt-2">
                <div class="col-6 col-sm-12 col-md-6 col-lg-6">
                  <label>Searching Date:</label>
                  {{ form.date }}
                </div>
                <div class="col-6 col-sm-12 col-md-6 col-lg-6">
                  <label>Teams:</label>
                  {{ form.teams }}
                </div>
              </div>                           
              <div class="row mx-2 my-3">
                <div class="col-12">
                  <button
                    class="btn btn-primary btn-lg"
                    type="submit"                    
                  >
                    <i class="fas fa-search fa-sm"></i> Search
                  </button>
                </div>
                <div class="col-12 pt-3">
                  {% comment %}
                  <a
                    class="btn btn-success btn-lg btn-block"
                    target="_blank"
                    href="{% url 'history_table' all_accounts=all_accounts account_number=account_number account_type=account_type all_dates=all_dates date_from=date_from date_to=date_to time_before=time_before time_past=time_past all_events=all_events event_1=event_1 event_2=event_2 %}"
                    ><i class="fas fa-table fa-sm pr-2"></i>Download Report</a
                  >
                  {% endcomment %}
                </div>
              </div>
            </div>
          </div>
        </form>

        <div class="row">
          <div class="col-12">
            <!-- Attendance Table -->
            <div class="card o-hidden border-left-dark shadow-lg my-5">
              <div class="card-header text-center">
                <h1 class="h4 text-primary my-2">Attendance Table</h1>
              </div>
              <div class="card-body p-0">
                <div class="table-responsive">
                  <table class="sortable table table-striped table-hover">
                    <thead class="thead-dark">
                      <tr>                 
                        <th scope="col">Name</th>
                        <th scope="col">ACE</th>
                        <th scope="col">Team</th>
                        <th scope="col">No. Leaves</th>
                        <th scope="col">% of attendance</th>
                        <th scope="col">% of attendance with leaves</th>
                        <th scope="col">Report</th>                        
                      </tr>
                    </thead>
                    <tbody>
                      {% for employee in employees %}
                      <tr>
                        <td>{{ employee.0 }}</td>
                        <td>{{ employee.1 }}</td>
                        <td>{{ employee.2 }}</td>
                        <td>{{ employee.3 }}</td>
                        <td>{{ employee.4|floatformat:"2" }}%</td>
                        <td>{{ employee.5|floatformat:"2" }}%</td>                                                
                        <td></td>                                                
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
          <div class="col-4">
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="//cdn.jsdelivr.net/timepicker.js/latest/timepicker.min.js"></script>
<script>
  var date_day = $("#id_date_day");

  $(document).ready(function (){
    date_day.hide();
  })
</script>


{% endblock %}
